---
title: Dart基础
date: 2022-05-01
# subSidebar: false
isTimeLine: true
isComment: false
tags:
 - Flutter
categories:
 -  Flutter
---

## 概述
* Dart是Google开发的一门编程语言
* Dart初期目标是成为下一代的web开发语言，只是没想到JS后来太厉害了
* Dart可用于全平台开发（web端打不过js，脚本服务端打不过Python和Java，跨平台移动应用找到自己了）
* Dart是一门面向对象语言

## 数据类型
Dart 类似 Java 语言，main 方法是它程序入口
```js
void main() {
    print('hello word');
}
```



### 变量与常量
* 使用var 声明变量，可赋予不同类型的值
* 未初始化时，默认值为 null
* 使用final声明一个只能赋值一次的变量
* 使用const声明常量
* 使用const声明的必须是编译期常量，在编译阶段就能确定它的值

```js
void main() {
  var a;
  print(a); // null
  a = 10;
  print(a); // 10
  a = 'hello';
  print(a); // hello
  var b = 20;
  print(b);
  final c = 20;
  // c = 10; // 出现错误提示
  const d = 10;
  // d = 2; // 出现错误提示
}
```




::: tip
面试题：const 与 final 的异同？(他们是有本质区别的)
:::




### 内置数据类型
默认内置了七种数据类型Number、String，Boolean、List、Map、Runes、Symbols

* 数值型-Number
    * 关键字：num，不像java中分很多类型，Dart的数值类型只区分整型和浮点型
    * 整型：int
    * 浮点型：double

```js
void main() {
  num a = 10;
  print(a); // 10
  a = 20.1;
  print(a); // 20.1
  int b = 1;
  print(b); // 1
  // b = 11.1; // 提示错误
  // int c = 1.1; // 提示错误
  double d = 10;
  print(d); // 10.0，可以赋值整型，会被默认转换
  double e = 11.1;
  print(e); // 11.1
}

// 查看源码可以发现，int、double都是继承 num 的
abstract class int extends num {
    ......
}

abstract class double extends num {
    ......
}

```
    

**数值型操作**

1、运算符：+、-、*、/、~/、%

2、常用属性：isNaN、isEven、isOdd等

```js
void main() {
  num a = 10;
  int b = 2;
  double c = 3;
  print(a + b); // 12
  print(a - b); // 8
  print(a * b); // 20
  print(a / b); // 5.0
  print(a ~/ b); // 5 取整
  print(a % b); // 0
  print(0 / 0); // NaN
  int d = 20;
  print(d.isEven); // true
  print(d.isOdd); // false
  int e = -100;
  print(e.abs()); // 100
  double f = 10.22;
  double h = 10.55;
  print(f.round()); // 10
  print(h.round()); // 11
  print(f.ceil()); // 11
  print(h.ceil()); // 11
  print(f.floor()); // 10
  print(h.floor()); // 10
  print(f.toInt()); // 10
  print(h.toDouble()); // 10.55
  print(d.toDouble()); // 20.0
}

// 还有很多方法，具体可以查看源码，或者查看文档

// isNaN，源码中定义
abstract class double extends num {
  static const double nan = 0.0 / 0.0;
  static const double infinity = 1.0 / 0.0;
  static const double negativeInfinity = -infinity;
  static const double minPositive = 5e-324;
  static const double maxFinite = 1.7976931348623157e+308;
  ....
}
```


* 字符串-String
    * 使用单引号，双引号创建字符串
    * 使用三个单引号或者双引号创建多行字符串
    * 使用 r 创建原始的raw字符串

```js
void main() {
  String str1 = 'kylo'; // ""
  print(str1); // kylo
  String str2 = '''hello
                   kylo
                   '''; // """
  print(str2); // 打印出来是换行的
  String str3 = 'hello \n kylo';
  print(str3); // 打印出来是换行的
  String str4 = r'hello \n kylo'; // 使用r，\n 不会被转译
  print(str4); // hello \n kylo
}
```

**字符串操作**

1、运算符：+、*、==、[]

2、插值表达式：${expression}，同 ES6 中插值表达式 

3、常用的属性：length、isEmpty、isNotEmpty 

4、常用的方法：contains()、substring()、startsWith()、endsWith()、indexOf()、lastIndexOf()、toLowerCase()、toUpperCase()、trim()、trimLeft()、trimRight()、split()、replaceXXX()等等

```js
 String str1 = 'Hello everybody';
  print(str1 + 'NOooooo'); // Hello everybodyNOooooo
  print(str1 * 3); // Hello everybodyHello everybodyHello everybody
  String str2 = 'zhangsan';
  print(str1 == str2); // false
  print(str2[0]); // z
  // 常用属性
  String str3 = 'hello';
  print(str3.length); // 5
  print(str3.isEmpty); // false
  print(str3.isNotEmpty); // true
  // 常用方法
  String str4 = 'this is new car';
  print(str4.contains('this')); // true
  print(str4.substring(0, 4)); // this，[0,4)，左闭右开
  print(str4.startsWith('t')); // true
  print(str4.endsWith('car')); // true
  print(str4.split(' ')); // [this, is, new, car]
  print(str4.replaceAll('this', 'that')); // that is new car
```






* 布尔型-Boolean
    * 使用bool表示布尔类型
    * 布尔值只有true或false

```js
bool isTrue = true;
bool isFalse = false;
```





* 列表-List
  * 在dart中List和数组是同一个概念
  * 创建List：var list = [1,2,3];
  * 创建不可变的List：var list = const [1,2,3];
  * 构造创建：var list = new List();
  

```js
void main() {
  var list = [1, 2, 3, 'kylo', true];
  List list2 = list;
  print(list); // [1, 2, 3, 'kylo', true];
  print(list2); // [1, 2, 3, 'kylo', true];
  list[0] = 555; // [555, 2, 3, 'kylo', true];
  print(list); //
  var conList = const [1, 2, 3];
  conList[0] = 555; // 没提醒，但是就是错的，应该提醒
  print(conList); // Unsupported operation: Cannot modify an unmodifiable list
}
```

**常用操作**

对List更多的是掌握他的常用操作

* [], length
* add(), insert()
* remove(), clear()
* indexOf(), lastIndexOf()
* sort(), sublist()
* shuffle(), asMap(), forEach()

```js
void main() {
  var list = ['zhangsan', 'lisi', 'wangwu', 'kylo', 'atongmu'];
  print(list[0]); // zhangsan
  print(list.length); // 5
  list.add('annan');
  print(list); // [zhangsan, lisi, wangwu, kylo, atongmu, annan]
  list.insert(1, 'jack');
  print(list); // [zhangsan, jack, lisi, wangwu, kylo, atongmu, annan]
  list.remove('lisi');
  print(list); // [zhangsan, jack, wangwu, kylo, atongmu, annan]
  list.sort();
  print(list); // [annan, atongmu, jack, kylo, wangwu, zhangsan]
  list.forEach(print); // annan  atongmu jack  kylo  wangwu  zhangsan
  var list4 = [1,2,3];
  print(list.asMap()); // 把list转换成map，{0:1, 1: 2, 2: 3}
}
```



* 键值对-Map
  * 创建Map: var language = {'first':'Dart', 'second': 'Java'};
  * 创建不可变Map：var language = const {'first':'Dart', 'second': 'Java'};
  * 构造创建：var language = new Map();

```js
// map 是 key，value 键值对形式的，如果key非字符串，map的底层会自动转换成字符串形式
void main() {
  var map = {'first': '111', 1: true, true: '222'};
  print(map); // {first: 111, 1: true, true: 222}
  print(map[0]); // null
  print(map['first']); // 111
  print(map[1]); // true
  print(map[true]); // 222
  var map1 = const {'first': '111', 1: true, true: '222'};
  map1[1] = false; // Unsupported operation: Cannot modify unmodifiable map
  var map3 = new Map();
}
```

**常用操作**

* [], length
* isEmpty(), isNotEmpty()
* keys, values
* containsKey(), containsValue()
* remove()
* forEach()

```js
void main() {
  var map = {'name1': 'kylo', 'name2': 'annan', 'name3': 'zhangsan'};
  print(map['name1']); // kylo
  print(map.length); // 3
  print(map.isEmpty); // false
  print(map.keys); // (name1, name2, name3)
  print(map.values); // (kylo, annan, zhangsan)
  print(map.containsKey('name1')); // true
  print(map.containsValue('wangwu')); // false
  map.remove('name1'); 
  print(map); // {name2: annan, name3: zhangsan}
  map.forEach(f); //  key=name2, value=annan   key=name3, value=zhangsan
}

void f(key, value) {
  print('key=${key}, value=${value}');
}
```

* Runes、Symbols（用的不多）

* 补充：dynamic，默认的

```js
void main() {
    var a;
    a = 10;
    a = 'Dart'; // 这里 a 就是 dynamic，他不属于基本数据类型 
    dynamic b = 20;
    b = 'JavaScript';
    var list = new List<dynamic>();
    list.add(1);
    list.add('hello');
    list.add(true);
    print(list); // [1, 'hello', true]
}
```

## 运算符

### 算术运算符

* 加减乘除：+、-、*、/、~/、%

* 递增递减：++var、var++、--var、var--

```js
void main() {
  int a = 10;
  print(a++); // 10
  print(++a); // 12
  print(a--); // 12
  print(--a); // 10
}
```

### 关系运算符

* ==、!=、>、<、>=、<=
* 判断内容是否相同使用 ==，判断对象是用其他方法的


### 逻辑运算符

* 运算符：!, &&, ||
* 作用：针对布尔型的运算


### 赋值运算符

* 基础运算符：=, ??=
* 复合运算符：+=, -=, *=, /=, %=, ~/=

```js
void main() {
  var a;
  a ??= 20;
  print(a); // 20, 有些类似默认赋值，如果有则显示原来的值，如果没有则显示默认值20
  var b = 10;
  b ??= 20;
  print(b); // 10
  int c = 20;
  print(a -= 1); // 19
  print(a += 3); // 22
  print(a /= 2); // 11.0
  print(a %= 2); // 1.0
  print(a ~/= 1); // 1
}
```


### 条件表达式

* 三目运算符：condition? expr1 : expr2; 和js相同
* ??运算符：expr1 ?? expr2, 如果expr1不为空，则使用expr1，如果expr1为空，则使用expr2

```js
void main() {
  int a = 1;
  var str1 = a == 1 ? '111' : '222';
  print(str1); // 111
  var b;
  var str2 = b ?? '333';
  print(str2); // 333
}
```


## 控制语句

### 条件语句

* if
* if...else if 
* if...else if...else


### 循环语句

* for
* for ... in，没有下标, 当我们需要使用下标时，可以使用for循环

```js
void main() {
  var list = [
    {'name': 'zhangsan'},
    {'name': 'lisi'},
    {'name': 'wangwu'},
    {'name': 'zhaoliu'},
    {'name': 'kylo'},
  ];
  for (Map item in list) {
    print(item);
  }
}
```

* while
* do...while
* 终止循环：break
* 跳出当前循环：continue
* switch...case 语句
  * 比较类型：num，String，编译期常量，对象，枚举
  * 非空case必须有一个break
  * default处理默认情况
  * **continue跳转标签，这个是很多其他语言没有的**

```js
void main() {
  String language = 'Dart';
  switch (language) {
    Test:
    case 'Java':
      print('this is Java');
      continue Go;
    case 'JavaScript':
      print('this is JavaScript');
      break;
    case 'Dart':
      print('this is Dart');
      continue Test;
    Go:
    case 'Go':
      print('this is Go');
      break;
  }
}
/**
 * this is Dart
   this is Java
   this is Go
 * 
*/
```




## 方法

* 方法也是对象，并且有具体类型Function
* 返回值类型、参数类型都可以省略
* 箭头语法： `=> expr` 是 `{return expr;}` 缩写。只适用于一个表达式
* 方法都有返回值。如果没有制定，默认 `return null`  

### 方法定义

```js
返回类型 方法名(参数1, 参数2,...) {
  方法体...
  return 返回值;
}

void main() {
  print(getName1('zhangsan', 33)); // my name is zhangsan, my age is 33
  print(getName2('zhangsan', 33)); // my name is zhangsan, my age is 33
  print(getName3('zhangsan', 33)); // null
  print(getName4('zhangsan', 33)); // my name is zhangsan, my age is 33
}

String getName1(String name, int age) {
  return 'my name is ${name}, my age is ${age}';
}

getName2(name, age) {
  return 'my name is ${name}, my age is ${age}';
}

getName3(name, age) {}

getName4(name, age) => 'my name is ${name}, my age is ${age}';
```

### 可选参数和默认参数

* 可选命名参数：`{ param1, param2.. }`
* 可选位置参数：`[param1, param2...]`
* 如果存在具体参数，可选参数声明，必须在参数后面
* 使用 = 给参数指定默认值
* 默认值只能是编译时常量

```js
void main() {
  print(getName1('zhangsan')); // my name is zhangsan, my age is 0, my gender is man
  print(getName1('zhangsan', age: 33)); // my name is zhangsan, my age is 33, my gender is man
  print(getName1('zhangsan', age: 33, gender:'women')); // my name is zhangsan, my age is 33, my gender is women
  print(getName3('zhangsan', age: 33, gender: 'women')); // my name is zhangsan, my age is 33, my gender is women
  print(getName4('zhangsan', 18)); // 不能跳过参数，必须按照顺序，所以更推荐第一种可选参数
}

// dart sdk升级到2.12以上之后，新增了空安全检查，所以下面的必须给一个默认值，或者设为 required，或者 ?
String getName1(String name, {int age = 0, String gender = 'man'}) {
  return 'my name is ${name}, my age is ${age}, my gender is ${gender}';
}

String getName2(String name, {int? age, String? gender}) {
  return 'my name is ${name}, my age is ${age}, my gender is ${gender}';
}

String getName3(String name, {required int age, required String gender}) {
  return 'my name is ${name}, my age is ${age}, my gender is ${gender}';
}

String getName4(String name, [int? age, String? gender]) {
  return 'my name is ${name}, my age is ${age}, my gender is ${gender}';
}
```

### 方法对象

方法就是一个对象，具有具体的类型Function

* 方法可作为对象赋值给其它变量
* 方法可作为参数传递给其它方法

```js
void main() {
  var newPrintName = printName;
  newPrintName('zhangsan'); // zhangsan
  Function fPrintName = printName;
  fPrintName('zhangsan'); // zhangsan
  var list = [1, 2, 3];
  list.forEach(print);
  var newList = ['k', 'y', 'l', 'o'];
  print(listTime(newList, times)); // [kkk, yyy, lll, ooo]
}

void printName(String name) {
  print(name);
}

List listTime(List list, String times(str)) {
  for (var index = 0; index < list.length; index++) {
    list[index] = times(list[index]);
  }
  return list;
}

String times(str) {
  return str * 3;
}
```



### 匿名方法

* 可赋值给变量，通过变量进行调用
* 可在其它方法中直接调用或传递给其它方法

```js
(参数1, 参数2) {
  方法体...
  return 返回值;
}

void main() {
  var func = (str) {
    print('func is ${str}');
  };
  func('hhhh'); // func is hhhh

  (() {
    print('hello'); // hello, 立即执行
  })();
}
```


### 闭包

和 js 中的闭包一样

* 闭包是一个方法（对象）
* 闭包定义在其它方法内部
* 闭包能够访问外部方法的局部变量，并持有其状态
* 使用匿名方法访问我们的闭包是更加常用的方式





## 面向对象编程







## 枚举&泛型